<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>æ–°å¢è¨ˆç•«æ¸¬è©¦</title>
<style>
body { font-family:"Microsoft JhengHei", sans-serif; margin:20px; }
label { display:block; margin:6px 0 2px; }
input { width:300px; padding:6px; }
button { padding:6px 12px; margin-top:8px; background:#0066cc; color:#fff; border:none; border-radius:4px; cursor:pointer; }
button:hover { background:#004999; }
pre { background:#f0f0f0; padding:10px; }
</style>
</head>
<body>

<h2>æ–°å¢è¨ˆç•«è³‡æ–™</h2>
<form id="projectForm">
  <label>è¨ˆç•«å¹´åº¦ <input type="text" name="è¨ˆç•«å¹´åº¦" required></label>
  <label>ç¶“è²»ä¾†æº <input type="text" name="ç¶“è²»ä¾†æº"></label>
  <label>åŸ·è¡Œæ©Ÿæ§‹ <input type="text" name="åŸ·è¡Œæ©Ÿæ§‹"></label>
  <label>åŸ·è¡Œå­¸ç³» <input type="text" name="åŸ·è¡Œå­¸ç³»"></label>
  <label>ä¸»æŒäºº <input type="text" name="ä¸»æŒäºº" required></label>
  <label>æŒ¹æ³¨æ–¹æ¡ˆ <input type="text" name="æŒ¹æ³¨æ–¹æ¡ˆ"></label>
  <label>è¨ˆç•«æœŸç¨‹ <input type="text" name="è¨ˆç•«æœŸç¨‹"></label>
  <label>è£œåŠ©é‡‘é¡ <input type="number" name="è£œåŠ©é‡‘é¡"></label>
  <label>CoPI <input type="text" name="CoPI"></label>
  <button type="submit">æ–°å¢</button>
</form>

<h2>æ–°å¢çµæœ</h2>
<pre id="result"></pre>

<script>
document.addEventListener("DOMContentLoaded", function(){
  const apiUrl = "https://script.google.com/macros/s/AKfycbzDBJ3X7whZCDO6Q8_gawauEYHN2o-Z89qpL9rSMUotzpD2OtE0Mlt07hAd8PwRBxbkRg/exec"; // ğŸ”‘ æ›¿æ›ä½ çš„ Web App URL

  document.getElementById("projectForm").addEventListener("submit", function(e){
    e.preventDefault();
    const data = Object.fromEntries(new FormData(this));
    console.log("é€å‡ºè³‡æ–™:", data);

    fetch(apiUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(res => {
      console.log(res);
      if(res.status === "success"){
        alert("æ–°å¢æˆåŠŸï¼");
        this.reset();
        document.getElementById("result").textContent = JSON.stringify(res.data, null, 2);
      } else {
        alert("æ–°å¢å¤±æ•—ï¼š" + (res.message || res.status));
      }
    })
    .catch(err => {
      console.error(err);
      alert("æ–°å¢å¤±æ•—ï¼š" + err);
    });
  });
});
</script>

</body>
</html>
